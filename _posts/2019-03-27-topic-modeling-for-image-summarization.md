---
layout: post
title:  "Суммаризация изображения с использованием тематического моделирования"
date:   2019-03-27
desc: "Суммаризация изображения с использованием тематического моделирования"
keywords: "image processing, topic modeling, summarization, translation"
categories: [image processing, topic modeling, summarization, translation]
tags: [image processing, topic modeling, summarization, translation]
icon: icon-html
---

# Abstract

<p onmouseover="this.innerHTML='With the rapid advancement in technology it is easy to take pictures, and easier still to share them with the world at large. In this digital age the image data we have has grown manifold over the past few years. Digital Cameras have allowed the capturing and storing of large number of images highly inexpensive and hence we can’t go on a trip without taking several hundreds of photographs. We take repeated shots till we find the perfect one. As a result, in a collection of images we end up having recurring and similar images which we would like to omit. Manually going through such a huge collection and picking out the best images is a highly laborious task. This paper deals with devising a way of summarizing a given collection of photographs to represent a distinct set of representative images. This would save the users a lot of effort while allowing the selection of the best images of the set which also represent the entire set. Here we employ a modified Latent Dirichlet Allocation technique, a generative probabilistic model, to partition the images from a ’Bag of words’ representation created using Scale Invariant Feature Transform (SIFT) vectors and then clustering these vectors into bins. We validate the results using subjective analysis based on 3 metrics by the people providing the image collection and also by a more general set of people.'" onmouseout="this.innerHTML='Благодаря быстрому прогрессу в технологиях легко фотографировать, и еще проще делиться ими со всем миром. В наш цифровой век данные об изображениях, которые мы получили, выросли в разы за последние несколько лет. Цифровые камеры позволили снимать и хранить большое количество изображений без особых усилий, и поэтому мы не можем отправиться в путешествие, не сделав несколько сотен фотографий. Мы делаем повторные снимки, пока не найдем идеальный. В результате в коллекции изображений мы получаем повторяющиеся и похожие изображения, которые мы хотели бы опустить. Вручную просмотреть такую огромную коллекцию и выбрать лучшие изображения - очень трудоемкая задача. Эта статья посвящена разработке способа суммирования данной коллекции фотографий для представления отдельного набора репрезентативных изображений. Это сэкономит пользователям много усилий, позволяя выбирать лучшие изображения из набора, которые также представляют весь набор. Здесь мы используем модифицированный метод латентного размещения Дирихле, чтобы разделить изображения используя представление «Мешок слов», созданного с использованием векторов, получаемых из Scale Invariant Feature Transform (SIFT), а затем сгруппировать эти векторы в кластеры. Мы проверяем результаты, используя субъективный анализ, основанный на 3 метриках людьми, обеспечивающими сбор изображений, а также более общим набором людей.'">Благодаря быстрому прогрессу в технологиях легко фотографировать, и еще проще делиться ими со всем миром. В наш цифровой век данные об изображениях, которые мы получили, выросли в разы за последние несколько лет. Цифровые камеры позволили снимать и хранить большое количество изображений без особых усилий, и поэтому мы не можем отправиться в путешествие, не сделав несколько сотен фотографий. Мы делаем повторные снимки, пока не найдем идеальный. В результате в коллекции изображений мы получаем повторяющиеся и похожие изображения, которые мы хотели бы опустить. Вручную просмотреть такую огромную коллекцию и выбрать лучшие изображения - очень трудоемкая задача. Эта статья посвящена разработке способа суммирования данной коллекции фотографий для представления отдельного набора репрезентативных изображений. Это сэкономит пользователям много усилий, позволяя выбирать лучшие изображения из набора, которые также представляют весь набор. Здесь мы используем модифицированный метод латентного размещения Дирихле, чтобы разделить изображения используя представление «Мешок слов», созданного с использованием векторов, получаемых из Scale Invariant Feature Transform (SIFT), а затем сгруппировать эти векторы в кластеры. Мы проверяем результаты, используя субъективный анализ, основанный на 3 метриках людьми, обеспечивающими сбор изображений, а также более общим набором людей.</p>

## Введение
<p onmouseover="this.innerHTML='The number of photographs being uploaded online is growing at an unprecedented rate. A recent estimate is that 500 million images are uploaded to the internet every day (just considering Flickr, Facebook, Instagram and Snapchat), a figure which is expected to double every year. [1]'" onmouseout="this.innerHTML='Количество загружаемых фотографий в интернет растет беспрецедентными темпами. По последним оценкам, 500 миллионов изображений загружаются в Интернет каждый день (только в Flickr, Facebook, Instagram и Snapchat), и эта цифра, как ожидается, будет удваиваться каждый год. [1]'">Количество загружаемых фотографий в интернет растет беспрецедентными темпами. По последним оценкам, 500 миллионов изображений загружаются в Интернет каждый день (только в Flickr, Facebook, Instagram и Snapchat), и эта цифра, как ожидается, будет удваиваться каждый год. [1]</p>

<p onmouseover="this.innerHTML='Nowadays it is common for consumers to buy digital camera and take thousands of photos of daily life. Photographers have a tendency of capturing every moment and thus take multiple photos of a scene leading to a lot of redundant images. At the end a user is left with the task of managing large number of photographs after each trip. After each trip a user, manually goes through all photos, identifies similar photographs and selects the best. Since all the tasks are manually performed by users, this work is very burdensome and time consuming. In order to assist the user, we propose an automatic image summarization technique.'" onmouseout="this.innerHTML='В наши дни потребители часто покупают цифровые фотоаппараты и делают тысячи фотографий повседневной жизни. Фотографы имеют тенденцию запечатлеть каждый момент и, таким образом, сделать несколько фотографий сцены, что приводит к большому количеству избыточных изображений. В конце пользователь остается с задачей управления большим количеством фотографий после каждой поездки. После каждой поездки он или она вручную просматривает все фотографии, идентифицирует похожие фотографии и выбирает лучшие. Поскольку все задачи выполняются пользователями вручную, эта работа очень обременительна и требует много времени.Чтобы помочь людям, мы предлагаем метод автоматического суммирования изображений.'">В наши дни потребители часто покупают цифровые фотоаппараты и делают тысячи фотографий повседневной жизни. Фотографы имеют тенденцию запечатлеть каждый момент и, таким образом, сделать несколько фотографий сцены, что приводит к большому количеству избыточных изображений. В конце пользователь остается с задачей управления большим количеством фотографий после каждой поездки. После каждой поездки он или она вручную просматривает все фотографии, идентифицирует похожие фотографии и выбирает лучшие. Поскольку все задачи выполняются пользователями вручную, эта работа очень обременительна и требует много времени.Чтобы помочь людям, мы предлагаем метод автоматического суммирования изображений.</p>

<p onmouseover="this.innerHTML='We begin by defining some terminology. Throughout the paper, we use the term photo interchangeably with image and view, all of which refer to an ordinary 2D image. We define a collection as a set of photos. In its most basic form, a summary is a set of photos that represents the most interesting visual content of a collection of images.'" onmouseout="this.innerHTML='Мы начнем с определения некоторой терминологии. На протяжении всей статьи мы используем термин «фотография» взаимозаменяемо с изображением и видом, и все они относятся к обычному двухмерному изображению. Мы определяем коллекцию как набор фотографий. В своей основной форме краткое содержание из изображений (summary) представляет собой набор фотографий, представляющих наиболее интересный визуальный контент из коллекции изображений.'">Мы начнем с определения некоторой терминологии. На протяжении всей статьи мы используем термин «фотография» взаимозаменяемо с изображением и видом, и все они относятся к обычному двухмерному изображению. Мы определяем коллекцию как набор фотографий. В своей основной форме краткое содержание из изображений (summary) представляет собой набор фотографий, представляющих наиболее интересный визуальный контент из коллекции изображений.</p>

<p onmouseover="this.innerHTML='The purpose of a summary is to quickly give a viewer an accurate impression of what an image collection is trying to represent. Our goal, then, given a set of photos μ of a single image collection S, is to compute a summary C ⊆ μ such that most of the interesting visual content in μ is represented in C. This paper discusses the techniques we use for achieving this goal.'" onmouseout="this.innerHTML='Цель summary - быстро дать человеку точное представление о том, что пытается представить коллекция изображений. Таким образом, наша цель, имея набор фотографий μ из коллекции изображений S, состоит в том, чтобы вычислить итоговое значение C ⊆ μ так, чтобы большая часть интересного визуального содержимого в μ была представлена в C. В этой статье обсуждаются методы, которые мы используем для достижения этой цели.'">Цель summary - быстро дать человеку точное представление о том, что пытается представить коллекция изображений. Таким образом, наша цель, имея набор фотографий μ из коллекции изображений S, состоит в том, чтобы вычислить итоговое значение C ⊆ μ так, чтобы большая часть интересного визуального содержимого в μ была представлена в C. В этой статье обсуждаются методы, которые мы используем для достижения этой цели.</p>

<p onmouseover="this.innerHTML='First, Using the SIFT vectors we represent every image in the form of ’bag of words’ by clustering these SIFT vectors into several bins, thereby representing each image as a histogram of probability distribution of these vectors over these bins. We then use topic modelling technique of Latent Dirichlet Allocation [2] to partition the collection of photographs into clusters. The best image is identified by the image vector with the least within cluster sum of square distances from other image vectors of the cluster.
'" onmouseout="this.innerHTML='Во-первых, используя векторы SIFT, мы представляем каждое изображение в форме «мешка слов», группируя эти векторы SIFT в несколько корзин, тем самым представляя каждое изображение в виде гистограммы распределения вероятности этих векторов по этим корзинам. Затем мы используем метод тематического моделирования, латентное размещение  Дирихле [2], чтобы разбить коллекцию фотографий на кластеры. Лучшее изображение идентифицируется вектором изображения с наименьшей в пределах кластера суммой квадратных расстояний от других векторов изображения кластера.'">Во-первых, используя векторы SIFT, мы представляем каждое изображение в форме «мешка слов», группируя эти векторы SIFT в несколько корзин, тем самым представляя каждое изображение в виде гистограммы распределения вероятности этих векторов по этим корзинам. Затем мы используем метод тематического моделирования, латентное размещение  Дирихле [2], чтобы разбить коллекцию фотографий на кластеры. Лучшее изображение идентифицируется вектором изображения с наименьшей в пределах кластера суммой квадратных расстояний от других векторов изображения кластера.</p>

<p onmouseover="this.innerHTML='We validate our results by judging the quality of summaries produced both on personal and general image collections. We get the summaries rated both by people who are a part of the images and the ones not a part of them.'" onmouseout="this.innerHTML='Мы проверяем наши результаты, оценивая качество summary, созданных как на личных, так и на публичных коллекциях изображений. Мы получаем summary, оцениваемые как людьми, которые встречаются на изображениях, так и теми, которые не встречаются.'">Мы проверяем наши результаты, оценивая качество summary, созданных как на личных, так и на публичных коллекциях изображений. Мы получаем summary, оцениваемые как людьми, которые встречаются на изображениях, так и теми, которые не встречаются.</p>

<p onmouseover="this.innerHTML='We claim that an effective subset summary should satisfy some desirable properties. These properties are:'" onmouseout="this.innerHTML='Мы утверждаем, что эффективное саммари подмножества должно удовлетворять некоторым желательным свойствам, таким как:'">Мы утверждаем, что эффективное саммари подмножества должно удовлетворять некоторым желательным свойствам, таким как:</p>

<ul>
  <li onmouseover="this.innerHTML='QUALITY of a photo summary determines the aggregate interestingness or attractiveness of the photos present in it.'"></li>
  <li onmouseover="this.innerHTML='DIVERSITY of a summary is a measure of its non- redundancy.'">
  <li onmouseover="this.innerHTML='COVERAGE ensures that the important concepts present in the image collection are also represented in the size constrained summary.'">
</ul>

<p onmouseover="this.innerHTML='The raters are asked to rate the summaries on these 3 properties. The results for the same are presented in the results section.'" onmouseout="this.innerHTML=''"></p>


<p onmouseover="this.innerHTML='For partitioning of images we are not using time- stamps[3] as they assume that similar images are clicked within a specified time interval. This assumption is often flawed and misleading and can lead to poor summarization and hence we avoid using the same to make any decisions. We also avoid the use of topic tags and geo-tags, as theeffectiveness of these is questionable. Instead we use SIFT feature vectors which are invariant to rotation, translation, scaling and partially invariant to illumination changes and affine or 3D projection which prove a good measure to identify similar images [4]. Using SIFT allows us to ignore rotation, illumination, scaling and other such effects and instead focus on the contents of the image. The exclusion of timestamp, topic tags and geo-tags and solely focusing on the image contents is one of the novelties in our paper. The use of topic modelling techniques, traditionally used for document classification to image summarization by representing images as documents is another major novelty in the approach we propose. This allows us to model the image contents in an efficient manner and use it for summarization. This is also what makes the approach scalable as the ultimate classification is not on the entire image but it’s representation as a document or more specifically as a histogram over topic probabilities and processing documents is much faster than directly applying classification algorithms on images. This effective processing allows for speedy implementation of the approach and allows us to process a large number of images in a feasible amount of time.'" onmouseout="this.innerHTML=''"></p>

<p onmouseover="this.innerHTML='The remainder of the paper is organized as follows: Literature Review is presented in section 2. Proposed algorithm for image summarization of a collection of photographs is explained in section 3. In section 4, experimental setup is mentioned along with results and discussions followed by section 5 which presents the conclusions of the paper. Finally section 6 discussed our future intentions and the work we plan to do to extend this project.'" onmouseout="this.innerHTML=''"></p>

# Обзор литературы

<p onmouseover="this.innerHTML='The task of summarizing a collection of photographs can be broadly divided into two parts namely clustering the given images and choosing the best image from the cluster. Most photo clustering techniques that have been used previously employ timestamps and content of the photo as the partitioning criteria. In 2003, Toyama [5] proposed an application built on top of the World Wide Media eXchange (WWMX) providing auto clustering functions according to geographic location tags. GPS information is also a very useful clustering criterion however current digital cameras with GPS system are not widely distributed, and hence it can’t be expected to always have geo-tagged images.
'" onmouseout="this.innerHTML=''"></p>

<p onmouseover="this.innerHTML='Yang and Wang in 2009 [6] used ’bag-of-words’ visual model for grouping scene images. This model has the role of giving similarity between images which is used to divide a large image collection into coarser groups. They quantize SIFT feature vectors using the Greed N-Best Paths (GNP) algorithm and further used area-ratio constraint to match the features between each pair of images. AutoAlbum [7] used time and photo creation order to make a temporally contiguous photo group. To provide the contiguous photo group they employ the best-first probabilistic model merging algorithm.'" onmouseout="this.innerHTML=''"></p>

<p onmouseover="this.innerHTML='Cooper in 2005 [8] found temporal similarity between images using logistic function using time intervals. He also visualized his clustering result using a DCT matrix.'" onmouseout="this.innerHTML=''"></p>

<p onmouseover="this.innerHTML='Graham [9] proposed Calendar Browser and Hierarchical Browser to exploit the timing information. He considers photo shoot times and semantically related photos tend to occur together when he constructs hierarchical photo structure. Boutell [10] in 2005 proposed a general probabilistic temporal context model which used the first-order Markov property and is used to integrate content-based and temporal context cues. Chum and Matas in 2009 [11] used the min-Hash algorithm to find out the cluster seeds and then the seeds are used as the visual queries to obtain the clusters.'" onmouseout="this.innerHTML=''"></p>

<p onmouseover="this.innerHTML='In 2008, Jang [12] proposed a clustering algorithm for concurrent digital photos obtained for multiple cameras. A colour based block matching is used to consider the content based similarity. In 2011, Ryu et al. [13] proposed a queue-based hierarchical clustering method using photo timestamps. They used recursive partitioning called by a priority queue enabling classified photo groups with maximum variance to be primarily selected.'" onmouseout="this.innerHTML=''"></p>

<p onmouseover="this.innerHTML='In 2007 Simon et al. [14] attempted to do a scene summarization of an image collection by using clustering techniques and trying to decompose an image into ’canonical views’ or views of interest. They also used timestamps and user tags for this task. Furthermore, they proposed a greedy algorithm to optimize their objective. A similar approach was proposed by Sinha et al. in papers [15] and [16], where a set cover function is used to model coverage, and a minimum disparity formulation is used to model diversity. They too optimize their objective using the same greedy algorithm.'" onmouseout="this.innerHTML=''"></p>

<p onmouseover="this.innerHTML='Denton et al. [17] use a semidefinite programming relaxation to select canonical views from a larger set of views, choosing views which are as similar as possible to the non-canonical views while being dissimilar to each other.'" onmouseout="this.innerHTML=''"></p>

<p onmouseover="this.innerHTML='Rother et al. [18] stitch together salient and spatially compatible blocks from the input image set to summarize the set of images with a ”digital tapestry”. Wang et al. [19] create a ”picture collage”, a 2D spatial arrangement of the images in the input set chosen to maximize the visibility of salient regions. Both these works try to determine the visual layout after already haven chosen the set of images to appear. We ignore issues of layout and focus on selecting the set of images to appear in the summary.'" onmouseout="this.innerHTML=''"></p>

<p onmouseover="this.innerHTML='Kim et al. [20] try to create image summaries as storyline graphs by using sparse time-varying directed graphs. They also perform video summarization, which is achieved by diversity ranking on the similarity graphs between images and video frames.'" onmouseout="this.innerHTML=''"></p>

<p onmouseover="this.innerHTML='Tschiatschek et al. [21] address the problem of image collection summarization by learning mixtures of submodular functions. They provide classes of submodular component functions (including some which are instantiated via a deep neural network) over which mixtures may be learnt. They formulate the learning of such mixtures as a supervised problem via large-margin structured prediction.'" onmouseout="this.innerHTML=''"></p>

<p onmouseover="this.innerHTML='Image tags and geo-tags have often been used in the past for the summarization task. For example Jaffe et al. [22] summarize a set of images using only tags and geotags. They try to correlate tags and geo-tags and try to overlay these images over a geographical map. Schmitz [23] relies on Flickr tags, which are typically noisier and less informative than the content of the images and are often non-existent. All of these approaches could be used to further organize our summaries. However, none of them take advantage of the visual information in the images to fill in for bad or missing metadata.'" onmouseout="this.innerHTML=''"></p>

# Тематическое моделирование с использованием SIFT векторов и тематического моделирования

<p onmouseover="this.innerHTML='Our proposed approach can be broadly classified into four categories. The approach is clearly explained by the means of a flowchart in Fig. 2. First we represent the images by applying SIFT on the images and representing the SIFT feature vectors in the 1024 dimensional space. The feature extraction technique is clearly explained by the means of the flowchart in Fig. 3. In the second step these image vectors are quantized into bins to create a probability histogram which is used to represent an image. In the third step, we apply LDA on these probability histograms to ultimately cluster images based on probability distribution over underlying set of topics identified by LDA. LDA assumes a generative probabilistic model on text documents and their underlying topics. Given a pre-defined number of topics, k, LDA models each topic as a probability distribution over words. Just as each topic is modeled as a probability distribution over words, each document is modeled as a probability distribution over topics. This probability distribution over topics is what is used to cluster images. Finally, after having clustered the images we choose a fixed number of images from each cluster as the representative of that cluster and ensure that the best images are chosen from each cluster. Picking a fixed number of images per cluster ensures that we choose a representative summary, that is all different kinds of images find representation in the image summary. The four steps are further explained in the sections to follow.'" onmouseout="this.innerHTML=''"></p>

<img src="{{ site.img_path }}/summary_w_topic_modeling/top_view_idea.png" width="75%">

<p onmouseover="this.innerHTML=''" onmouseout="this.innerHTML=''"></p>

<p onmouseover="this.innerHTML=''" onmouseout="this.innerHTML=''"></p>

<p onmouseover="this.innerHTML=''" onmouseout="this.innerHTML=''"></p>

<p onmouseover="this.innerHTML=''" onmouseout="this.innerHTML=''"></p>

<p onmouseover="this.innerHTML=''" onmouseout="this.innerHTML=''"></p>

<p onmouseover="this.innerHTML=''" onmouseout="this.innerHTML=''"></p>

<p onmouseover="this.innerHTML=''" onmouseout="this.innerHTML=''"></p>

<p onmouseover="this.innerHTML=''" onmouseout="this.innerHTML=''"></p>

<p onmouseover="this.innerHTML=''" onmouseout="this.innerHTML=''"></p>
